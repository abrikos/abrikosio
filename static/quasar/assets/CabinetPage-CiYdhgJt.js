import{Q as Pe,j as je}from"./selection-K-xUS1L7.js";import{m as ne,ad as _e,g as J,ae as he,c,Q as Ve,af as $e,h as s,a4 as le,ag as ye,C as oe,r as z,N as Fe,D as Ae,ah as Se,M as Le,w as Ie,n as Oe,i as De,ai as Ee,aj as ve,ak as Qe,$ as Z,R as Te,al as Me,am as We,d as Ke,W as He,Y as Xe,Z as Ye,_ as W,f as $,a0 as te,a6 as G,a9 as fe}from"./index-BnrZpbN0.js";import{Q as me}from"./QForm-CjSNPOcV.js";import{u as Ge,a as Ze,b as Je,c as et,d as tt,e as at,f as ge,g as lt,Q as pe}from"./QInput-DEWW7FXG.js";import{u as qe,a as xe}from"./use-dark-vWacLrWd.js";import{h as ue,b as nt}from"./format-Bqz_r1l1.js";import{Q as ut}from"./QPage-D-Me68ZS.js";import{u as it}from"./use-quasar-_Sq_U_aw.js";import{_ as ot}from"./PasswordConfirmation.vue_vue_type_script_setup_true_lang-DU4mW1_B.js";import{_ as rt}from"./UserAvatar.vue_vue_type_script_setup_true_lang-CwBvciRy.js";import"./focus-manager-DhdJisJs.js";const st={xs:8,sm:10,md:14,lg:20,xl:24},dt=ne({name:"QChip",props:{...qe,..._e,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:m,emit:u}){const{proxy:{$q:n}}=J(),r=xe(e,n),v=he(e,st),h=c(()=>e.selected===!0||e.icon!==void 0),x=c(()=>e.selected===!0?e.iconSelected||n.iconSet.chip.selected:e.icon),d=c(()=>e.iconRemove||n.iconSet.chip.remove),q=c(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),C=c(()=>{const o=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(o?` text-${o} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(q.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(r.value===!0?" q-chip--dark q-dark":"")}),N=c(()=>{const o=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},g={...o,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||n.lang.label.remove};return{chip:o,remove:g}});function B(o){o.keyCode===13&&y(o)}function y(o){e.disable||(u("update:selected",!e.selected),u("click",o))}function t(o){(o.keyCode===void 0||o.keyCode===13)&&(oe(o),e.disable===!1&&(u("update:modelValue",!1),u("remove")))}function i(){const o=[];q.value===!0&&o.push(s("div",{class:"q-focus-helper"})),h.value===!0&&o.push(s(le,{class:"q-chip__icon q-chip__icon--left",name:x.value}));const g=e.label!==void 0?[s("div",{class:"ellipsis"},[e.label])]:void 0;return o.push(s("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},ye(m.default,g))),e.iconRight&&o.push(s(le,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&o.push(s(le,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:d.value,...N.value.remove,onClick:t,onKeyup:t})),o}return()=>{if(e.modelValue===!1)return;const o={class:C.value,style:v.value};return q.value===!0&&Object.assign(o,N.value.chip,{onClick:y,onKeyup:B}),Ve("div",o,i(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[$e,e.ripple]])}}});function X(e,m,u,n){const r=[];return e.forEach(v=>{n(v)===!0?r.push(v):m.push({failedPropValidation:u,file:v})}),r}function ae(e){e?.dataTransfer&&(e.dataTransfer.dropEffect="copy"),oe(e)}const ke={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ce=["rejected"];function ze({editable:e,dnd:m,getFileInput:u,addFilesToQueue:n}){const{props:r,emit:v,proxy:h}=J(),x=z(null),d=c(()=>r.accept!==void 0?r.accept.split(",").map(l=>(l=l.trim(),l==="*"?"*/":(l.endsWith("/*")&&(l=l.slice(0,l.length-1)),l.toUpperCase()))):null),q=c(()=>parseInt(r.maxFiles,10)),C=c(()=>parseInt(r.maxTotalSize,10));function N(l){if(e.value)if(l!==Object(l)&&(l={target:null}),l.target?.matches('input[type="file"]')===!0)l.clientX===0&&l.clientY===0&&Fe(l);else{const U=u();U!==l.target&&U?.click(l)}}function B(l){e.value&&l&&n(null,l)}function y(l,U,O,D){let b=Array.from(U||l.target.files);const S=[],V=()=>{S.length!==0&&v("rejected",S)};if(r.accept!==void 0&&d.value.indexOf("*/")===-1&&(b=X(b,S,"accept",_=>d.value.some(k=>_.type.toUpperCase().startsWith(k)||_.name.toUpperCase().endsWith(k))),b.length===0))return V();if(r.maxFileSize!==void 0){const _=parseInt(r.maxFileSize,10);if(b=X(b,S,"max-file-size",k=>k.size<=_),b.length===0)return V()}if(r.multiple!==!0&&b.length!==0&&(b=[b[0]]),b.forEach(_=>{_.__key=_.webkitRelativePath+_.lastModified+_.name+_.size}),D===!0){const _=O.map(k=>k.__key);b=X(b,S,"duplicate",k=>_.includes(k.__key)===!1)}if(b.length===0)return V();if(r.maxTotalSize!==void 0){let _=D===!0?O.reduce((k,L)=>k+L.size,0):0;if(b=X(b,S,"max-total-size",k=>(_+=k.size,_<=C.value)),b.length===0)return V()}if(typeof r.filter=="function"){const _=r.filter(b);b=X(b,S,"filter",k=>_.includes(k))}if(r.maxFiles!==void 0){let _=D===!0?O.length:0;if(b=X(b,S,"max-files",()=>(_++,_<=q.value)),b.length===0)return V()}if(V(),b.length!==0)return b}function t(l){ae(l),m.value!==!0&&(m.value=!0)}function i(l){oe(l),(l.relatedTarget!==null||Ae.is.safari!==!0?l.relatedTarget!==x.value:document.elementsFromPoint(l.clientX,l.clientY).includes(x.value)===!1)===!0&&(m.value=!1)}function o(l){ae(l);const U=l.dataTransfer.files;U.length!==0&&n(null,U),m.value=!1}function g(l){if(m.value===!0)return s("div",{ref:x,class:`q-${l}__dnd absolute-full`,onDragenter:ae,onDragover:ae,onDragleave:i,onDrop:o})}return Object.assign(h,{pickFiles:N,addFiles:B}),{pickFiles:N,addFiles:B,onDragover:t,onDragleave:i,processFiles:y,getDndNode:g,maxFilesNumber:q,maxTotalSizeNumber:C}}const ct=ne({name:"QFile",inheritAttrs:!1,props:{...Je,...Ze,...ke,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Ge,...Ce],setup(e,{slots:m,emit:u,attrs:n}){const{proxy:r}=J(),v=et(),h=z(null),x=z(!1),d=tt(e),{pickFiles:q,onDragover:C,onDragleave:N,processFiles:B,getDndNode:y}=ze({editable:v.editable,dnd:x,getFileInput:p,addFilesToQueue:E}),t=at(e),i=c(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),o=c(()=>ge(i.value)),g=c(()=>i.value.map(f=>f.name).join(", ")),l=c(()=>ue(i.value.reduce((f,w)=>f+w.size,0))),U=c(()=>({totalSize:l.value,filesNumber:i.value.length,maxFiles:e.maxFiles})),O=c(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:d.value,...n,id:v.targetUid.value,disabled:v.editable.value!==!0})),D=c(()=>"q-file q-field--auto-height"+(x.value===!0?" q-file--dnd":"")),b=c(()=>e.multiple===!0&&e.append===!0);function S(f){const w=i.value.slice();w.splice(f,1),_(w)}function V(f){const w=i.value.indexOf(f);w!==-1&&S(w)}function _(f){u("update:modelValue",e.multiple===!0?f:f[0])}function k(f){f.keyCode===13&&Le(f)}function L(f){(f.keyCode===13||f.keyCode===32)&&q(f)}function p(){return h.value}function E(f,w){const P=B(f,w,i.value,b.value),K=p();K!=null&&(K.value=""),P!==void 0&&((e.multiple===!0?e.modelValue&&P.every(ee=>i.value.includes(ee)):e.modelValue===P[0])||_(b.value===!0?i.value.concat(P):P))}function I(){return[s("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function M(){if(m.file!==void 0)return i.value.length===0?I():i.value.map((w,P)=>m.file({index:P,file:w,ref:this}));if(m.selected!==void 0)return i.value.length===0?I():m.selected({files:i.value,ref:this});if(e.useChips===!0)return i.value.length===0?I():i.value.map((w,P)=>s(dt,{key:"file-"+P,removable:v.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{S(P)}},()=>s("span",{class:"ellipsis",textContent:w.name})));const f=e.displayValue!==void 0?e.displayValue:g.value;return f.length!==0?[s("div",{class:e.inputClass,style:e.inputStyle,textContent:f})]:I()}function A(){const f={ref:h,...O.value,...t.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:E};return e.multiple===!0&&(f.multiple=!0),s("input",f)}return Object.assign(v,{fieldClass:D,emitValue:_,hasValue:o,inputRef:h,innerValue:i,floatingLabel:c(()=>o.value===!0||ge(e.displayValue)),computedCounter:c(()=>{if(e.counterLabel!==void 0)return e.counterLabel(U.value);const f=e.maxFiles;return`${i.value.length}${f!==void 0?" / "+f:""} (${l.value})`}),getControlChild:()=>y("file"),getControl:()=>{const f={ref:v.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return v.editable.value===!0&&Object.assign(f,{onDragover:C,onDragleave:N,onKeydown:k,onKeyup:L}),s("div",f,[A()].concat(M()))}}),Object.assign(r,{removeAtIndex:S,removeFile:V,getNativeElement:()=>h.value}),Se(r,"nativeEl",()=>h.value),lt(v)}}),vt={..._e,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},ie=50,we=2*ie,Be=we*Math.PI,ft=Math.round(Be*1e3)/1e3,mt=ne({name:"QCircularProgress",props:{...vt,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:m}){const{proxy:{$q:u}}=J(),n=he(e),r=c(()=>{const y=(u.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(u.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-y}deg)`:`rotate3d(0, 0, 1, ${y-90}deg)`}}),v=c(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),h=c(()=>we/(1-e.thickness/2)),x=c(()=>`${h.value/2} ${h.value/2} ${h.value} ${h.value}`),d=c(()=>nt(e.value,e.min,e.max)),q=c(()=>e.max-e.min),C=c(()=>e.thickness/2*h.value),N=c(()=>{const y=(e.max-d.value)/q.value,t=e.rounded===!0&&d.value<e.max&&y<.25?C.value/2*(1-y/.25):0;return Be*y+t});function B({thickness:y,offset:t,color:i,cls:o,rounded:g}){return s("circle",{class:"q-circular-progress__"+o+(i!==void 0?` text-${i}`:""),style:v.value,fill:"transparent",stroke:"currentColor","stroke-width":y,"stroke-dasharray":ft,"stroke-dashoffset":t,"stroke-linecap":g,cx:h.value,cy:h.value,r:ie})}return()=>{const y=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&y.push(s("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:ie-C.value/2,cx:h.value,cy:h.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&y.push(B({cls:"track",thickness:C.value,offset:0,color:e.trackColor})),y.push(B({cls:"circle",thickness:C.value,offset:N.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const t=[s("svg",{class:"q-circular-progress__svg",style:r.value,viewBox:x.value,"aria-hidden":"true"},y)];return e.showValue===!0&&t.push(s("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},m.default!==void 0?m.default():[s("div",d.value)])),s("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:n.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:d.value},ye(m.internal,t))}}});function be(e){return(e*100).toFixed(2)+"%"}const gt={...qe,...ke,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},Ue=[...Ce,"start","finish","added","removed"];function pt(e,m){const u=J(),{props:n,slots:r,emit:v,proxy:h}=u,{$q:x}=h,d=xe(n,x);function q(a,F,R){if(a.__status=F,F==="idle"){a.__uploaded=0,a.__progress=0,a.__sizeLabel=ue(a.size),a.__progressLabel="0.00%";return}if(F==="failed"){h.$forceUpdate();return}a.__uploaded=F==="uploaded"?a.size:R,a.__progress=F==="uploaded"?1:Math.min(.9999,a.__uploaded/a.size),a.__progressLabel=be(a.__progress),h.$forceUpdate()}const C=c(()=>n.disable!==!0&&n.readonly!==!0),N=z(!1),B=z(null),y=z(null),t={files:z([]),queuedFiles:z([]),uploadedFiles:z([]),uploadedSize:z(0),updateFileStatus:q,isAlive:()=>Qe(u)===!1},{pickFiles:i,addFiles:o,onDragover:g,onDragleave:l,processFiles:U,getDndNode:O,maxFilesNumber:D,maxTotalSizeNumber:b}=ze({editable:C,dnd:N,getFileInput:ee,addFilesToQueue:re});Object.assign(t,e({props:n,slots:r,emit:v,helpers:t,exposeApi:a=>{Object.assign(t,a)}})),t.isBusy===void 0&&(t.isBusy=z(!1));const S=z(0),V=c(()=>S.value===0?0:t.uploadedSize.value/S.value),_=c(()=>be(V.value)),k=c(()=>ue(S.value)),L=c(()=>C.value===!0&&t.isUploading.value!==!0&&(n.multiple===!0||t.queuedFiles.value.length===0)&&(n.maxFiles===void 0||t.files.value.length<D.value)&&(n.maxTotalSize===void 0||S.value<b.value)),p=c(()=>C.value===!0&&t.isBusy.value!==!0&&t.isUploading.value!==!0&&t.queuedFiles.value.length!==0);Te(Me,de);const E=c(()=>"q-uploader column no-wrap"+(d.value===!0?" q-uploader--dark q-dark":"")+(n.bordered===!0?" q-uploader--bordered":"")+(n.square===!0?" q-uploader--square no-border-radius":"")+(n.flat===!0?" q-uploader--flat no-shadow":"")+(n.disable===!0?" disabled q-uploader--disable":"")+(N.value===!0?" q-uploader--dnd":"")),I=c(()=>"q-uploader__header"+(n.color!==void 0?` bg-${n.color}`:"")+(n.textColor!==void 0?` text-${n.textColor}`:""));Ie(t.isUploading,(a,F)=>{F===!1&&a===!0?v("start"):F===!0&&a===!1&&v("finish")});function M(){n.disable===!1&&(t.abort(),t.uploadedSize.value=0,S.value=0,K(),t.files.value=[],t.queuedFiles.value=[],t.uploadedFiles.value=[])}function A(){n.disable===!1&&w(["uploaded"],()=>{t.uploadedFiles.value=[]})}function f(){w(["idle","failed"],({size:a})=>{S.value-=a,t.queuedFiles.value=[]})}function w(a,F){if(n.disable===!0)return;const R={files:[],size:0},Q=t.files.value.filter(j=>a.indexOf(j.__status)===-1?!0:(R.size+=j.size,R.files.push(j),j.__img!==void 0&&window.URL.revokeObjectURL(j.__img.src),!1));R.files.length!==0&&(t.files.value=Q,F(R),v("removed",R.files))}function P(a){n.disable||(a.__status==="uploaded"?t.uploadedFiles.value=t.uploadedFiles.value.filter(F=>F.__key!==a.__key):a.__status==="uploading"?a.__abort():S.value-=a.size,t.files.value=t.files.value.filter(F=>F.__key!==a.__key?!0:(F.__img!==void 0&&window.URL.revokeObjectURL(F.__img.src),!1)),t.queuedFiles.value=t.queuedFiles.value.filter(F=>F.__key!==a.__key),v("removed",[a]))}function K(){t.files.value.forEach(a=>{a.__img!==void 0&&window.URL.revokeObjectURL(a.__img.src)})}function ee(){return y.value||B.value.getElementsByClassName("q-uploader__input")[0]}function re(a,F){const R=U(a,F,t.files.value,!0),Q=ee();Q!=null&&(Q.value=""),R!==void 0&&(R.forEach(j=>{if(t.updateFileStatus(j,"idle"),S.value+=j.size,n.noThumbnails!==!0&&j.type.toUpperCase().startsWith("IMAGE")){const ce=new Image;ce.src=window.URL.createObjectURL(j),j.__img=ce}}),t.files.value=t.files.value.concat(R),t.queuedFiles.value=t.queuedFiles.value.concat(R),v("added",R),n.autoUpload===!0&&t.upload())}function se(){p.value===!0&&t.upload()}function Y(a,F,R){if(a===!0){const Q={type:"a",key:F,icon:x.iconSet.uploader[F],flat:!0,dense:!0};let j;return F==="add"?(Q.onClick=i,j=de):Q.onClick=R,s(Z,Q,j)}}function de(){return s("input",{ref:y,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:n.accept,multiple:n.multiple===!0?"multiple":void 0,capture:n.capture,onMousedown:Fe,onClick:i,onChange:re})}function Re(){return r.header!==void 0?r.header(H):[s("div",{class:"q-uploader__header-content column"},[s("div",{class:"flex flex-center no-wrap q-gutter-xs"},[Y(t.queuedFiles.value.length!==0,"removeQueue",f),Y(t.uploadedFiles.value.length!==0,"removeUploaded",A),t.isUploading.value===!0?s(ve,{class:"q-uploader__spinner"}):null,s("div",{class:"col column justify-center"},[n.label!==void 0?s("div",{class:"q-uploader__title"},[n.label]):null,s("div",{class:"q-uploader__subtitle"},[k.value+" / "+_.value])]),Y(L.value,"add"),Y(n.hideUploadBtn===!1&&p.value===!0,"upload",t.upload),Y(t.isUploading.value,"clear",t.abort)])])]}function Ne(){return r.list!==void 0?r.list(H):t.files.value.map(a=>s("div",{key:a.__key,class:"q-uploader__file relative-position"+(n.noThumbnails!==!0&&a.__img!==void 0?" q-uploader__file--img":"")+(a.__status==="failed"?" q-uploader__file--failed":a.__status==="uploaded"?" q-uploader__file--uploaded":""),style:n.noThumbnails!==!0&&a.__img!==void 0?{backgroundImage:'url("'+a.__img.src+'")',backgroundSize:n.thumbnailFit}:null},[s("div",{class:"q-uploader__file-header row flex-center no-wrap"},[a.__status==="failed"?s(le,{class:"q-uploader__file-status",name:x.iconSet.type.negative,color:"negative"}):null,s("div",{class:"q-uploader__file-header-content col"},[s("div",{class:"q-uploader__title"},[a.name]),s("div",{class:"q-uploader__subtitle row items-center no-wrap"},[a.__sizeLabel+" / "+a.__progressLabel])]),a.__status==="uploading"?s(mt,{value:a.__progress,min:0,max:1,indeterminate:a.__progress===0}):s(Z,{round:!0,dense:!0,flat:!0,icon:x.iconSet.uploader[a.__status==="uploaded"?"done":"clear"],onClick:()=>{P(a)}})])]))}Oe(()=>{t.isUploading.value===!0&&t.abort(),t.files.value.length!==0&&K()});const H={};for(const a in t)De(t[a])===!0?Se(H,a,()=>t[a].value):H[a]=t[a];return Object.assign(H,{upload:se,reset:M,removeUploadedFiles:A,removeQueuedFiles:f,removeFile:P,pickFiles:i,addFiles:o}),Ee(H,{canAddFiles:()=>L.value,canUpload:()=>p.value,uploadSizeLabel:()=>k.value,uploadProgressLabel:()=>_.value}),m({...t,upload:se,reset:M,removeUploadedFiles:A,removeQueuedFiles:f,removeFile:P,pickFiles:i,addFiles:o,canAddFiles:L,canUpload:p,uploadSizeLabel:k,uploadProgressLabel:_}),()=>{const a=[s("div",{class:I.value},Re()),s("div",{class:"q-uploader__list scroll"},Ne()),O("uploader")];t.isBusy.value===!0&&a.push(s("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[s(ve)]));const F={ref:B,class:E.value};return L.value===!0&&Object.assign(F,{onDragover:g,onDragleave:l}),s("div",F,a)}}const bt=()=>!0;function _t(e){const m={};return e.forEach(u=>{m[u]=bt}),m}const ht=_t(Ue),yt=({name:e,props:m,emits:u,injectPlugin:n})=>ne({name:e,props:{...gt,...m},emits:We(u)===!0?{...ht,...u}:[...Ue,...u],setup(r,{expose:v}){return pt(n,v)}});function T(e){return typeof e=="function"?e:()=>e}const Ft="QUploader",St={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>e=>e.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},qt=["factoryFailed","uploaded","failed","uploading"];function xt({props:e,emit:m,helpers:u}){const n=z([]),r=z([]),v=z(0),h=c(()=>({url:T(e.url),method:T(e.method),headers:T(e.headers),formFields:T(e.formFields),fieldName:T(e.fieldName),withCredentials:T(e.withCredentials),sendRaw:T(e.sendRaw),batch:T(e.batch)})),x=c(()=>v.value>0),d=c(()=>r.value.length!==0);let q;function C(){n.value.forEach(t=>{t.abort()}),r.value.length!==0&&(q=!0)}function N(){const t=u.queuedFiles.value.slice(0);u.queuedFiles.value=[],h.value.batch(t)?B(t):t.forEach(i=>{B([i])})}function B(t){if(v.value++,typeof e.factory!="function"){y(t,{});return}const i=e.factory(t);if(!i)m("factoryFailed",new Error("QUploader: factory() does not return properly"),t),v.value--;else if(typeof i.catch=="function"&&typeof i.then=="function"){r.value.push(i);const o=g=>{u.isAlive()===!0&&(r.value=r.value.filter(l=>l!==i),r.value.length===0&&(q=!1),u.queuedFiles.value=u.queuedFiles.value.concat(t),t.forEach(l=>{u.updateFileStatus(l,"failed")}),m("factoryFailed",g,t),v.value--)};i.then(g=>{q===!0?o(new Error("Aborted")):u.isAlive()===!0&&(r.value=r.value.filter(l=>l!==i),y(t,g))}).catch(o)}else y(t,i||{})}function y(t,i){const o=new FormData,g=new XMLHttpRequest,l=(p,E)=>i[p]!==void 0?T(i[p])(E):h.value[p](E),U=l("url",t);if(!U){console.error("q-uploader: invalid or no URL specified"),v.value--;return}const O=l("formFields",t);O!==void 0&&O.forEach(p=>{o.append(p.name,p.value)});let D=0,b=0,S=0,V=0,_;g.upload.addEventListener("progress",p=>{if(_===!0)return;const E=Math.min(V,p.loaded);u.uploadedSize.value+=E-S,S=E;let I=S-b;for(let M=D;I>0&&M<t.length;M++){const A=t[M];if(I>A.size)I-=A.size,D++,b+=A.size,u.updateFileStatus(A,"uploading",A.size);else{u.updateFileStatus(A,"uploading",I);return}}},!1),g.onreadystatechange=()=>{g.readyState<4||(g.status&&g.status<400?(u.uploadedFiles.value=u.uploadedFiles.value.concat(t),t.forEach(p=>{u.updateFileStatus(p,"uploaded")}),m("uploaded",{files:t,xhr:g})):(_=!0,u.uploadedSize.value-=S,u.queuedFiles.value=u.queuedFiles.value.concat(t),t.forEach(p=>{u.updateFileStatus(p,"failed")}),m("failed",{files:t,xhr:g})),v.value--,n.value=n.value.filter(p=>p!==g))},g.open(l("method",t),U),l("withCredentials",t)===!0&&(g.withCredentials=!0);const k=l("headers",t);k!==void 0&&k.forEach(p=>{g.setRequestHeader(p.name,p.value)});const L=l("sendRaw",t);t.forEach(p=>{u.updateFileStatus(p,"uploading",0),L!==!0&&o.append(l("fieldName",p),p,p.name),p.xhr=g,p.__abort=()=>{g.abort()},V+=p.size}),m("uploading",{files:t,xhr:g}),n.value.push(g),L===!0?g.send(new Blob(t)):g.send(o)}return{isUploading:x,isBusy:d,abort:C,upload:N}}const kt={name:Ft,props:St,emits:qt,injectPlugin:xt},Ct=yt(kt),Lt=Ke({__name:"CabinetPage",setup(e){const m=it(),u=He(),n=z({password:"",password2:""}),r=z({});async function v(x){if(!u.user)return;x&&(u.user.avatar=null);const d=await fe.patch(`/user/${u.user.id}/`,u.user);m.notify({message:d.data.status,color:"green"})}async function h(x){if(!u.user)return;const d=await fe.post(`/user/${u.user.id}/set_avatar/`,x,{headers:{"Content-Type":"multipart/form-data"}});m.notify({message:d.data.status,color:"green"})}return(x,d)=>(Ye(),Xe(ut,null,{default:W(()=>[$(Pe,null,{default:W(()=>[$(je,null,{default:W(()=>[...d[5]||(d[5]=[te("Cabinet",-1)])]),_:1})]),_:1}),$(me,{onSubmit:x.setPassword},{default:W(()=>[$(ot,{modelValue:n.value,"onUpdate:modelValue":d[0]||(d[0]=q=>n.value=q),errors:r.value},null,8,["modelValue","errors"]),$(Z,{type:"submit"},{default:W(()=>[...d[6]||(d[6]=[te("Save",-1)])]),_:1})]),_:1},8,["onSubmit"]),$(me,{onSubmit:d[3]||(d[3]=q=>v())},{default:W(()=>[$(pe,{modelValue:G(u).user.first_name,"onUpdate:modelValue":d[1]||(d[1]=q=>G(u).user.first_name=q),label:"First Name"},null,8,["modelValue"]),$(pe,{modelValue:G(u).user.last_name,"onUpdate:modelValue":d[2]||(d[2]=q=>G(u).user.last_name=q),label:"Last Name"},null,8,["modelValue"]),$(ct),$(Z,{type:"submit"},{default:W(()=>[...d[7]||(d[7]=[te("Save",-1)])]),_:1})]),_:1}),$(rt,{user:G(u).user},null,8,["user"]),$(Z,{onClick:d[4]||(d[4]=q=>v(!0))},{default:W(()=>[...d[8]||(d[8]=[te("Delete",-1)])]),_:1}),$(Ct,{url:"",onAdded:h})]),_:1}))}});export{Lt as default};
