import{a as B,Q as p}from"./QInput-D0K0f_kZ.js";import{l as A,r as g,G as I,af as q,o as Q,g as k,h as D,m as R,I as j,D as C,t as N,V as U,ag as $,d as M,a9 as O,a1 as T,aa as _,f as c,a6 as G,a2 as E,ac as K,ab as W,a5 as z,F as H,a7 as J}from"./index-D11pVnpz.js";import"./use-dark-DfycrRHP.js";const L=A({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(r,{slots:u,emit:s}){const v=k(),i=g(null);let e=0;const t=[];function b(o){const d=typeof o=="boolean"?o:r.noErrorFocus!==!0,m=++e,w=(a,n)=>{s(`validation${a===!0?"Success":"Error"}`,n)},h=a=>{const n=a.validate();return typeof n.then=="function"?n.then(l=>({valid:l,comp:a}),l=>({valid:!1,comp:a,err:l})):Promise.resolve({valid:n,comp:a})};return(r.greedy===!0?Promise.all(t.map(h)).then(a=>a.filter(n=>n.valid!==!0)):t.reduce((a,n)=>a.then(()=>h(n).then(l=>{if(l.valid===!1)return Promise.reject(l)})),Promise.resolve()).catch(a=>[a])).then(a=>{if(a===void 0||a.length===0)return m===e&&w(!0),!0;if(m===e){const{comp:n,err:l}=a[0];if(l!==void 0&&console.error(l),w(!1,n),d===!0){const F=a.find(({comp:P})=>typeof P.focus=="function"&&j(P.$)===!1);F!==void 0&&F.comp.focus()}}return!1})}function y(){e++,t.forEach(o=>{typeof o.resetValidation=="function"&&o.resetValidation()})}function x(o){o!==void 0&&C(o);const d=e+1;b().then(m=>{d===e&&m===!0&&(r.onSubmit!==void 0?s("submit",o):o?.target!==void 0&&typeof o.target.submit=="function"&&o.target.submit())})}function V(o){o!==void 0&&C(o),s("reset"),N(()=>{y(),r.autofocus===!0&&r.noResetFocus!==!0&&f()})}function f(){B(()=>{if(i.value===null)return;(i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1))?.focus({preventScroll:!0})})}U($,{bindComponent(o){t.push(o)},unbindComponent(o){const d=t.indexOf(o);d!==-1&&t.splice(d,1)}});let S=!1;return I(()=>{S=!0}),q(()=>{S===!0&&r.autofocus===!0&&f()}),Q(()=>{r.autofocus===!0&&f()}),Object.assign(v.proxy,{validate:b,resetValidation:y,submit:x,reset:V,focus:f,getValidationComponents:()=>t}),()=>D("form",{class:"q-form",ref:i,onSubmit:x,onReset:V},R(u.default))}}),X={email:[r=>r&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)||"Wrong email"]},ae=M({__name:"SignupPage",setup(r){const u=g({}),s=g({email:Math.random()+"@gg.com",password:"1"});async function v(){const e=await J().signup(s.value);if(console.log(e),e.data.error){for(const t in e.data.error)e.data.error[t]=e.data.error[t].join();u.value=e.data.error}}return(i,e)=>(T(),O(H,null,[_("div",null,G(u.value),1),c(L,{onSubmit:v},{default:E(()=>[c(p,{modelValue:s.value.email,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.email=t),label:"Email",type:"email",rules:K(X).email,error:!!u.value.email,"error-message":u.value.email},null,8,["modelValue","rules","error","error-message"]),c(p,{modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.password=t),label:"Password",error:!!u.value.password,"error-message":u.value.password},null,8,["modelValue","error","error-message"]),c(p,{modelValue:s.value.password2,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.password2=t),label:"Password confirm",error:!!u.value.password2,"error-message":u.value.password2},null,8,["modelValue","error","error-message"]),c(W,{type:"submit"},{default:E(()=>[...e[3]||(e[3]=[z("Sign up",-1)])]),_:1})]),_:1})],64))}});export{ae as default};
